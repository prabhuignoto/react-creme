@use 'sass:map';
@use 'position.scss';
@use 'colors.scss';

@mixin set-keyframes($name, $attrs, $reverse: false) {
  $from: from;
  $to: to;

  @if $reverse {
    $from: to;
    $to: from;
  }

  @keyframes #{$name} {
    #{$from} {
      @each $name, $value in map.get($attrs, 'from') {
        #{$name}: #{$value};
      }
    }

    #{$to} {
      @each $name, $value in map.get($attrs, 'to') {
        #{$name}: #{$value};
      }
    }
  }
}

%animation-default {
  animation-duration: 0.5s;
  animation-timing-function: ease-in;
}

@mixin set-settings($dur: 0.5s, $timing-func: ease-in, $infinite: false) {
  animation-delay: 0;
  animation-duration: $dur;
  animation-timing-function: $timing-func;

  @if $infinite {
    animation-iteration-count: infinite;
  }
}

%halo-common {
  @include position.position-abs('center center');
  content: '';
  display: block;
  height: 100%;
  width: 99%;
}

%halo-common-rtl {
  @include position.position-abs('center right');
  content: '';
  display: block;
  height: 100%;
  width: 99%;
}

@mixin halo(
  $border-radius: 2px,
  $outline-offset: 2px,
  $halo-effect: true,
  $rtl: false
) {
  $focus-settings: (
    from: (
      border: 1px solid rgba(colors.$white, 0.1),
    ),
    to: (
      border: 2px solid rgba(colors.$primary, 0.75),
    ),
  );
  $halo-settings: (
    from: (
      box-shadow: 0 0 1px 1px rgba(colors.$white, 0.1),
    ),
    to: (
      box-shadow: 0 0 1px 7px rgba(colors.$primary, 0.25),
    ),
  );
  z-index: 1;

  &.rc-focus,
  &.rc-lost-focus,
  &.rc-halo {
    outline: 0;
    position: relative;
  }

  &::before,
  &::after {
    @include set-settings(0.1s, linear);
    border-radius: $border-radius;
    outline-offset: $outline-offset;
    // z-index: 5;
  }

  &.rc-focus:not(.rc-disabled)::before {
    @if $rtl {
      @extend %halo-common-rtl;
    } @else {
      @extend %halo-common;
    }
    @include set-keyframes(outline-focus, $focus-settings);
    animation-name: outline-focus;
    border: 2px solid rgba(colors.$primary, 0.75);
    border-radius: 4px;
    box-shadow: inset 0 0 6px 2px rgba(colors.$secondary, 0.5);
  }

  &.rc-lost-focus:not(.rc-disabled)::before {
    @if $rtl {
      @extend %halo-common-rtl;
    } @else {
      @extend %halo-common;
    }
    @include set-keyframes(outline-de-focus, $focus-settings, true);
    animation-name: outline-de-focus;
    border: 1px solid rgba(colors.$white, 0.1);
    border-radius: 4px;
  }

  // @if $halo-effect {
  &.rc-halo:not(.rc-disabled)::after {
    @if $rtl {
      @extend %halo-common-rtl;
    } @else {
      @extend %halo-common;
    }
    @include set-keyframes(halo-focus, $halo-settings);
    animation-name: halo-focus;
    box-shadow: 0 0 1px 7px rgba(colors.$primary, 0.25);
    z-index: -1;
  }

  &.rc-de-halo:not(.rc-disabled)::after {
    @if $rtl {
      @extend %halo-common-rtl;
    } @else {
      @extend %halo-common;
    }
    @include set-keyframes(halo-de-focus, $halo-settings, true);
    animation-name: halo-de-focus;
    box-shadow: 0 0 1px 1px rgba(colors.$white, 0.1);
  }
  // }
}
